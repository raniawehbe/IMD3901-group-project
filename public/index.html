<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMD3901 Term Project</title>
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
</head>
<body>

<script>
            AFRAME.registerComponent('add-ui', {
            schema: {
                    default: '',
                    parse: AFRAME.utils.styleParser.parse
                    },

            init: function () {
                
                const el = this.el;
                console.log('I am ready!');

                el.addEventListener('click', function() {
                    

                    var entityEl = document.createElement('a-entity');
                    //entityEl.setAttribute('add-UI', '');
                    entityEl.setAttribute('id', "ui");
                    entityEl.setAttribute('position', "0 1.461 0");
                    entityEl.setAttribute('scale', "3.084 2.355 0.239");
                    entityEl.setAttribute('geometry', {primitive: 'box', width:0.4, height:0.4, depth:0.4});
                    entityEl.setAttribute('material', "color: '#ACC'");
                      
                    
                    el.sceneEl.appendChild(entityEl);
                    

                });
            }
            });

            AFRAME.registerComponent('visibility', {
            schema: {
                duration: {type: 'number', default:20000.0},  //duration is in milliseconds
            },
            multiple: false, //do not allow multiple instances of this component on this entity
            init: function() {
                
                //get a local reference to our entities and set some property variables
                const Context_AF = this;
                //Context_AF2  = this;

                Context_AF.question      = document.querySelector('#box2');
                Context_AF.question.setAttribute('visible', "false");

                Context_AF.question2       = document.querySelector('#box');
                height = Context_AF.question2.getAttribute('position');

                console.log(height);

                //Context_AF.el.addEventListener('click', function() {

                    if(height.y == 0.6){
                        Context_AF.question.setAttribute('visible', "true");
                        console.log("height reached");
                   }
                
                //});        
              
               
            },
            
            });
 
    </script>

    <a-scene>
        <!-- AFrame--> 

        <a-entity camera wasd-controls look-controls position="0 1.6 0">
            <a-entity cursor="rayOrigin:mouse;" raycaster="far:20; interval:200; objects:.interactive"></a-entity>
        </a-entity>

        <a-entity id="box"
                  class="interactive" add-ui visibility
                  position="0 0.2 0"
                  geometry="primitive:box; width:0.4; height:0.4; depth:0.4;" 
                  material="color:rgb(255, 100, 100)"
                  animation__mouseenter="property:material.color; type:color; to:rgb(255, 0, 0); startEvents:mouseenter; dur:200"
                  animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 100); startEvents:mouseleave; dur:200"
                  animation__click="property:position.y; to:0.6; startEvents:click; dur:300" 
                  animation__rotation="property:rotation; to:0 360 0; loop:true; dur:15000; startEvents:click;" shadow></a-entity>>
        </a-entity>

        <a-entity id="box2" 
        class="interactive" 
        position="2.5 0.2 0.2"
        geometry="primitive:box; width:0.4; height:0.4; depth:0.4;" 
        material="color:rgb(255, 100, 255)"
        animation__mouseenter="property:material.color; type:color; to:rgb(250, 0, 250); startEvents:mouseenter; dur:200"
        animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 255); startEvents:mouseleave; dur:200"
        animation__click="property:position.y; to:0.6; startEvents:click; dur:300" 
        animation__rotation="property:rotation; to:0 360 0; loop:true; dur:15000; startEvents:click;" shadow></a-entity>>
</a-entity>

        <!--<a-box position="2 0.2 -3.00" scale=" 1 1 1" color="#FF00FF"
                animation__click="property:rotation; to:0 360 0; loop:true; dur:60000 startEvents:click">
        </a-box> -->

        <a-entity id="plane"
                  position="0 0.01 0"
                  rotation="-90 0 0"
                  scale="10 10 10"
                  geometry="primitive:plane; width:1.0; height:1.0;" 
                  material="color:rgb(0, 255, 0);">
        </a-entity>

        
        <a-entity environment="preset:default"></a-entity>
    </a-scene>
</body>
</html>
