<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMD3901 Term Project</title>
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="/js/aframe-environment-component.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.2.0/dist/aframe-environment-component.min.js"></script>
    <script src="https://rawgit.com/rdub80/aframe-gui/master/dist/aframe-gui.min.js"></script>
    
</head>
<body>

  <script>
    AFRAME.registerComponent('add-ui', {
    schema: {
            default: '',
            parse: AFRAME.utils.styleParser.parse
            },

    init: function () {
        
        const el = this.el;
        console.log('I am ready!');

        el.addEventListener('click', function() {
            

            var entityEl = document.createElement('a-entity');
            //entityEl.setAttribute('add-UI', '');
            entityEl.setAttribute('id', "ui");
            entityEl.setAttribute('position', "-0.999 2.741 1.609");
            entityEl.setAttribute('rotation', "0 36.925 0");
            entityEl.setAttribute('scale', "3.084 2.355 0.239");
            entityEl.setAttribute('geometry', {primitive: 'box', width:0.4, height:0.4, depth:0.4});
            entityEl.setAttribute('material', "color: '#ACC'");
              
            
            el.sceneEl.appendChild(entityEl);
            

        });
    }
    });

    AFRAME.registerComponent('spinning-effect', {
  schema: {
    duration: {type: 'number', default:20000.0},  //duration is in milliseconds
  },
  multiple: false, //do not allow multiple instances of this component on this entity
  init: function() {
    
    //get a local reference to our entities and set some property variables
    const Context_AF = this;
    Context_AF.walls      = document.querySelector('#chair');
    Context_AF.isSpinning = false;
    
    //let's add the basic animation to teh walls entity
    //note that it is not enabled initially
    Context_AF.walls.setAttribute('animation', {property:'position.y', to:0, dur:300, easing:'linear'});
     
    //listen on click
    Context_AF.el.addEventListener('click', function() {
      if (Context_AF.isSpinning === true) {
        console.log('stop spinning');
        Context_AF.walls.setAttribute('animation', {to:0});
        Context_AF.isSpinning = false;
      }
      else {
        console.log('spinning');
        Context_AF.walls.setAttribute('animation', {to:0.9});
        Context_AF.isSpinning = true;
      }
    });
  },
  

});

</script>

<a-scene start-experience>
    <a-assets timeout="10000">
     
    <a-asset-item id="room_model"     response-type="arraybuffer" src="/assets/1800's/room.glb"></a-asset-item>
    <a-asset-item id="bed_model"     response-type="arraybuffer" src="/assets/1800's/bed.glb"></a-asset-item>
    <a-asset-item id="carpet_model"     response-type="arraybuffer" src="/assets/1800's/carpet.glb"></a-asset-item>
    <a-asset-item id="carpet2_model"     response-type="arraybuffer" src="/assets/1800's/carpet.glb"></a-asset-item>
    <a-asset-item id="Fireplace_model"     response-type="arraybuffer" src="/assets/1800's/Fireplace.glb"></a-asset-item>
    <a-asset-item id="chair_model"     response-type="arraybuffer" src="/assets/1800's/chaiir.glb"></a-asset-item>
    <a-asset-item id="closet_model"     response-type="arraybuffer" src="/assets/1800's/closet.glb"></a-asset-item>
    <a-asset-item id="frame_model"     response-type="arraybuffer" src="/assets/1800's/frame.glb"></a-asset-item>
    <a-asset-item id="mirror_model"     response-type="arraybuffer" src="/assets/1800's/mirror.glb"></a-asset-item>
    <a-asset-item id="teddy_model"     response-type="arraybuffer" src="/assets/1800's/teddy.glb"></a-asset-item>
    <a-asset-item id="hockeyStick_model"     response-type="arraybuffer" src="/assets/1800's/hockeyStick.glb"></a-asset-item>
    <a-asset-item id="hockeyStick2_model"     response-type="arraybuffer" src="/assets/1800's/hockeyStick.glb"></a-asset-item>
    <a-asset-item id="table_model"     response-type="arraybuffer" src="/assets/1800's/table.glb"></a-asset-item>
   
    
  </a-assets>

  <a-entity camera wasd-controls look-controls position="0 1.6 0">
    <a-entity cursor="rayOrigin:mouse;" raycaster="far:20; interval:200; objects:.interactive"></a-entity>
    <a-entity light="type:spot; intensity:1.4; castShadow:true; shadowBias:-0.0005; angle:40; penumbra:0.3;" position="0.5 -0.5 0" rotation="0 0 0"></a-entity>
    
    <a-gui-cursor id="cursor"
						  raycaster="objects: [gui-interactable]"
						  fuse="false"
				>
				</a-gui-cursor> <!-- /cursor -->
    </a-entity>
          
  
  <a-entity id="room" position="6 0 0" rotation="0 -90 0" scale="6 6 6"
            gltf-model="#room_model"
            
            shadow></a-entity>

  <a-entity id="bed" position="1.5 0 3" rotation="0 90 0" scale="5 5 5"
            gltf-model="#bed_model"
            
            shadow></a-entity>

  <a-entity id="carpet" position="1.5 0.1 4" rotation="0 180 0" scale="0.1 0.1 0.1"
            gltf-model="#carpet_model"
            
            shadow></a-entity>
  <a-entity id="carpet2" position="6 0.1 -1" rotation="0 90 0" scale="0.2 0.2 0.2"
            gltf-model="#carpet2_model"
            
            shadow></a-entity>
            
  <a-entity id="Fireplace" position="7 0 -10" rotation="0 0 0" scale="0.08 0.08 0.08"
            gltf-model="#Fireplace_model"
            
            shadow></a-entity>

<a-entity position="11 0 -10">
  <a-entity id="chair" class="interactive" spinning-effect position="0 0 0" rotation="0 -120 0" scale="1 1 1"
            gltf-model="#chair_model"
            
            shadow>
  </a-entity>
</a-entity>

  <a-entity id="closet" position="1.7 0 -10" rotation="0 -90 0" scale="0.03 0.03 0.03"
            gltf-model="#closet_model"
            
            shadow></a-entity>

  <a-entity id="frame" position="2 5 -13" rotation="0 180 0" scale="2 2 2"
            gltf-model="#frame_model"
            
            shadow></a-entity>

  <a-entity id="mirror" position="14.3 0 -7" rotation="0 -90 0" scale="0.02 0.02 0.02"
            gltf-model="#mirror_model"
            
            shadow></a-entity>

  <a-entity id="clue1" position = "-1 0 1.6">         
    <a-entity id="teddy" class= "interactive" add-ui position="0 0.3 0" rotation="-90 110 0" scale="0.03 0.03 0.03"
              gltf-model="#teddy_model"
              animation__click="property:position.y; to:1.9; startEvents:click; dur:300" 
              animation__rotation="property:rotation; to:-90 490 0; loop:true; dur:20000; startEvents:click;"
              shadow>
    </a-entity>
  </a-entity> 

  <a-entity id="clue2" position = "8.5 0 -8.7">
    <a-entity id="hockeyStick" class="interactive" position="0 0 0" rotation="-3 0 0" scale="0.02 0.02 0.02"
              gltf-model="#hockeyStick_model"
              animation__click="property:position.y; to:0.9; startEvents:click; dur:300" 
              animation__rotation="property:rotation; to:-3 490 0; loop:true; dur:20000; startEvents:click;"
              shadow>
    </a-entity>
  </a-entity>

  <a-entity id="hockeyStick2" position="7.5 0 -8.7" rotation="4.7 180 10" scale="0.02 0.02 0.02"
            gltf-model="#hockeyStick2_model"
            
            shadow></a-entity>

  <a-entity id="table" position="4 0 4" rotation="0 0 0" scale="0.02 0.02 0.02"
            gltf-model="#table_model"
            
            shadow></a-entity>

  <a-entity id="rooms">
    <a-entity class="ground"  geometry="primitive:plane; width:20; height:25;" material="color:grey;" position="6 0.01 0" rotation="-90 0 0" shadow="cast:false; receive:true;"></a-entity>
    
  </a-entity>

  <a-gui-flex-container 
	flex-direction="column" justify-content="center" align-items="normal" component-padding="0.1" opacity="0.7" width="3.5" height="4.5"
	position="15.499 2.5 -1.424" rotation="0 -90 0"
>
... gui items here...
  <a-gui-label 
          width="2.5" height="0.75"
          position="0 1.639 0.01"
          value="Answer Question"
          font-family="Arial"
          margin="0 0 0.05 0"
        >
    </a-gui-label>
    
    <a-gui-button 
      width="2.5" height="0.75"
      onclick="buttonActionFunction" key-code="32"
      position="-0.853 0.288 0.010"
      scale="0.611 0.796 1"
      value="option 1"
      font-family="Arial"
      margin="0 0 0.05 0"
    >
    </a-gui-button>

    <a-gui-button 
      width="2.5" height="0.75"
      onclick="buttonActionFunction" key-code="32"
      position="-0.853 0.288 0.010"
      scale="0.611 0.796 1"
      value="option 2"
      font-family="Arial"
      margin="0 0 0.05 0"
    >
    </a-gui-button>

    <a-gui-button 
      width="2.5" height="0.75"
      onclick="buttonActionFunction" key-code="32"
      position="-0.853 0.288 0.010"
      scale="0.611 0.796 1"
      value="option 3"
      font-family="Arial"
      margin="0 0 0.05 0"
    >
    </a-gui-button>

    <a-gui-button 
      width="2.5" height="0.75"
      onclick="buttonActionFunction" key-code="32"
      position="-0.853 0.288 0.010"
      scale="0.611 0.796 1"
      value="option 4"
      font-family="Arial"
      margin="0 0 0.05 0"
    >
    </a-gui-button>

      
</a-gui-flex-container>
  
  
  
  <a-entity environment="preset:default"></a-entity>
</a-scene>
</body>
</html>
